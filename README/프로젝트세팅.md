### Collision ì„¸íŒ…

> ë°œìƒí•œ ë¬¸ì œ : í‚¤ë„¤ë§ˆí‹± ì„¤ì •ì„ í‚¤ë©´ OnCollider OnTriggerì´ ì¸ì‹ì´ ì•ˆë˜ëŠ” ì˜¤ë¥˜ê°€ ìˆë‹¤.

**â‘  Projectile**
<div align=center>
    <img src="2023-05-17-21-04-32.png" width=500px><br>
    Projectileì˜ ì„¤ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
</div>

**â‘¡ í‚¤ë„¤ë§ˆí‹± ì„¸íŒ…ì„ í‚¤ë©´ íŠ¸ë¦¬ê±° ì—”í„°ê°€ í™œì„±í™” ë˜ì§€ ì„ë•Œ**

<div align=center>
    <img src="2023-05-17-17-50-35.png" width=500px><br>
    Edit -> Project Setting -> Physics
</div>

**â‘¢ ëŒ€ì¶© ì‘ë™ ì•ˆí–ˆë˜ ì½”ë“œ**

*
    ```cs
    using System;
    using System.Collections;
    using System.Collections.Generic;
    using UnityEngine;
    using UnityEngine.Events;
    using Newtonsoft.Json;
    using Newtonsoft.Json.Linq;

    public class Projectile : MonoBehaviour {
        public GameObject HitEffect;
        public Collider HitCollider;
        public ParticleSystem Particle;
        public float HitBoxLifeTime;
        public Dictionary<Affector_PlayerState ,IModifier> Modifiers;

        public LayerMask ownerMask;
        //private void OnCollisionEnter(Collision other) "Collision"
        //private void OnTriggerEnter(Collider other)    "Collider"
        // ì´ ì½”ë“œê°€ ë¶™ì–´ìˆëŠ” ì½œë¼ì´ë” ì»´í¬ë„ŒíŠ¸ê°€ IsTriggerì´ ë˜ì•¼ ì‘ë™ í•˜ëŠ”ê²ƒ
        private void OnTriggerEnter(Collider other) {
            if(ownerMask.value == other.gameObject.layer) {return;}
            Debug.Log($"{other.gameObject.name}, Collider Trigger");
            other.gameObject.TryGetComponent<IDamagable>(out IDamagable damagebleEntity);
            other.gameObject.TryGetComponent<IAffectable>(out IAffectable affectableEntity);
            damagebleEntity.GetDamaged(5);
            affectableEntity.AsyncAffectHandler(this.affectorType,new PoisonState(damagebleEntity).AsyncAffectorCoroutine);
        }
    }
    ```

**â‘£ ì°¸ê³ **

* https://answers.unity.com/questions/209656/having-a-kinematic-rigidbody-detect-collision-with.html

* https://linecode.tistory.com/5

---

### ëª¬ìŠ¤í„°ì˜ êµ¬ì¡°

<div align=center>
    <img src="2023-05-18-09-15-53.png" width=250px><br>
    Edit -> Project Setting -> Physics
</div>

```txt
ëª¬ìŠ¤í„° êµ¬ì¡°
    ëª¬ìŠ¤í„°
    â”œâ”€â”€ ì›”ë“œìŠ¤í˜ì´ìŠ¤
    â”‚   â”œâ”€â”€ ëª¨ë¸ : 3D ë¦¬ì†ŒìŠ¤ë“¤ì„ ì €ì¥í•œë‹¤
    â”‚   â”œâ”€â”€ VFXBucket : íŒŒí‹°í´, í”¼ê²© ì´í™íŠ¸ì˜ ìƒì„±
    â”‚   â”œâ”€â”€ ProjectileBucket : íˆ¬ì‚¬ì²´ ìƒì„±ì§€ì 
    â”‚   â””â”€â”€ Bilboard UI : ìºë¦­í„°ì— í‘œí•¨ëœ Worldìº”ë²„ìŠ¤
    â””â”€â”€ ìŠ¤í¬ë¦° ìŠ¤í˜ì´ìŠ¤
```

---

### Destroying assets is not permitted to avoid data loss.

> ì¦‰, ë‹ˆê°€ ì‚­ì œí•˜ë ¤ëŠ” ì˜¤ë¸Œì íŠ¸ê°€ í”„ë¦¬í©ì´ëƒ? í•´ì„œ ë°ì´í„° ì•ˆì „ì„ ìœ„í•´ ëœ¨ëŠ” ì˜¤ë¥˜
> ë³µì‚¬ í•´ë†“ê³  ì‚­ì œí•˜ë€ë‹¤.

**â‘  í”„ë¡œì íƒ€ì¼ ì½”ë“œ Before & After**

* before
    ```cs
    /*Projectile*/

    public void InstanciateProjectile(GameObject _owner, Quaternion _angle){
        spawnOwner = _owner;
        Instantiate(gameObject, transform.position, _angle);

    }
    public void InstanciateProjectile(GameObject _owner){
        spawnOwner = _owner;
        Instantiate(gameObject, transform);
    }
    ```
* after
    ```cs
    /*Projectile*/
    
    //ì—¬ê¸°ë¥¼ í†µí•´ì„œ ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œ ë†ˆì„ í˜¸ì¶œ í•  ìˆ˜ ìˆë‹¤.
    public GameObject InstanciateProjectile(GameObject _owner, Transform parent){
        spawnOwner = _owner;
        return Instantiate(gameObject, parent.position, parent.rotation);
    }
    ```

**â‘¡ í”„ë¡œì íƒ€ì¼ ë²„í‚· ì½”ë“œ Before & After**

* before
    ```cs
    /*ProjectileBucket.cs*/

    public void ProjectileInstantiator(Projectile projectile){
        projectile.InstanciateProjectile(gameObject);
        Destroy(projectile, 0.6f);
    }
    ```
* after
    ```cs
    /*ProjectileBucket.cs*/
    
    public void ProjectileInstantiator(Projectile projectile){
        Destroy(projectile.InstanciateProjectile(gameObject, transform), 0.6f);
    }
    ```



https://forum.unity.com/threads/destroying-assets-is-not-permitted-to-avoid-data-loss.1270514/

---

### ScriptableObject Data ì‚¬ìš©

> ë‹¤ìŒì€ ìŠ¤í¬ë¦½í„°ë¸” ì˜¤ë¸Œì íŠ¸ë¥¼ ì‹¤í—˜í•˜ê¸° ìœ„í•´ì„œ ì„ì‹œë¡œ ë„£ì—ˆë˜ ì½”ë“œì˜€ê³ , í˜„ì¬ëŠ” ì—†ë‹¤.
> ë‹¤ìŒì´ ì„¤ëª…í•˜ëŠ” ë°”ëŠ” í”Œë¼ì´ ì›¨ì´íŠ¸ê°€ ë˜ëŠ” ê°ì²´ë¥¼ ë³€ê²½ ì‹œí‚¤ì§€ ë§ˆë¼
> ì´ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ëŠ” ëª¨ë“  ê°ì²´ì— ì˜í–¥ìœ¼ ë¼ì¹˜ê¸° ë•Œë¬¸ë‹¤.

```
/*Sandbag.cs*/
/*
[ContextMenu("GetDamaged", false, int.MaxValue)]
public void GetDamaged(){
    //this.sandbagData.CurHP -= 334;
    CurHP -= 334;
    //this.hpChangedEvent.Invoke();
    //if (this.sandbagData.CurHP <= 0) {Die();}
    if (CurHP <= 0) {Die();}
}
// ê³µìœ  ë˜ëŠ” ë°ì´í„° ì´ë¯€ë¡œ ì¸ìŠ¤í„´ìŠ¤ë§ˆë‹¤ ì°¨ì´ë‚˜ëŠ” ê°’ì„ ì§€ì •í•´ì„œëŠ” ì•ˆëœë‹¤.
//private void Update() {
//    if (this.sandbagData.CurHP <= 0){Die();}
//}
*/
```

---

### ë©”ì‰¬ì˜ ìœ„ì¹˜
ë¸”ë Œë”

![](2023-05-18-11-06-44.png)

ìœ ë‹ˆí‹° 
![](2023-05-18-11-07-42.png)

---

### DynamicsArchtecture

í”Œë ˆì´ì–´, ëª¬ìŠ¤í„°ì™€ ê°™ì€ Entityì˜ ë™ì‘ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì†Œí†µí•˜ë„ë¡ í•œë‹¤.

ë””ë²„í”„ì˜ ì‚¬ìš©ë²•
```cs
private void OnTriggerEnter(Collider other) {
    //ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ë¥¼ ë°›ëŠ”ë‹¤.
    IDamagable damagebleEntity = other.gameObject.GetComponent<IDamagable>();
    IAffectable affectableEntity = other.gameObject.
    GetComponent<IAffectable>();

    //ì „ë‹¬ í•˜ê¸°
    damagebleEntity.GetDamaged(_amount: 5, HitEffect);
    //ë””ë²„í”„ëŠ” newë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•˜ê³ ,
    //AsyncAffectorCoroutineì— ê·¸ íš¨ê³¼(ë§¤ì†Œë“œ)ê°€ ë‹´ê²¨ ìˆë‹¤.
    //IAffectableëŠ” AsyncAffectorCoroutineì„ ì²˜ë¦¬í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë‹¤. 
    affectableEntity.AsyncAffectHandler(this.affectorType,new PoisonState(other.gameObject).AsyncAffectorCoroutine);
}
```

```cs
//ìƒì„±ìì— ì´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ëŒ€ìƒì„ ë„£ì–´ ì¤€ë‹¤
PoisonState poison = new PoisonState(other.gameObject);
affectableEntity.AsyncAffectHandler(this.affectorType,poison.AsyncAffectorCoroutine);
```

---

### Pipeline
ì•ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ì´ë€,
ëª¬ìŠ¤í„°ì™€ í”Œë ˆì´ì–´, í”Œë ˆì´ã„´ì–´ì™€ ë¬´ê¸°, í”Œë ˆì´ì–´ì™€ ë¶€í’ˆ ë“±ë“±
ê°ê¸° ë‹¤ë¥¸ê²ƒë“¤ê³¼ ë°ì´í„° í†µì‹ ì„ ìœ„í•œ í´ë˜ìŠ¤ê°€ ë ê²ƒì´ë‹¤.

ëª¨ë“  ëŠ¥ë ¥ì¹˜ ë³€í™”ëŠ” ë¬´ì¡°ê±´ íŒŒì´í”„ë¼ì¸ê³¼ì˜ ì—°ì‚°ì„ í†µí•´ì„œ ì´ë¤„ì§„ë‹¤.

### ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ ì‹œë¦¬ì–¼ë¼ì´ì¦ˆí™”
A í´ë˜ìŠ¤ë¥¼ í¬í•¨í•˜ëŠ”ê³³ì— Aë¥¼ ì¸ìŠ¤í™í„°ì— ë³´ì—¬ì§€ê²Œ í•˜ê³  ì‹¶ë‹¤ë©´..
```cs
[System.Serializable]
public class A {
    [field : SerializeField] var one;
    [field : SerializeField] var two;
    [field : SerializeField] var three;
    [field : SerializeField] var four;
    ...
}
```

```cs
[field : SerializeField]
A a;
```

ì‚¬ìš©í•œ ì˜ˆì‹œ
![](2023-05-20-16-32-33.png)

```cs
[System.Serializable]
public class EquipmentAddingData {
    
    [field : SerializeField] public int      MaxHP       {get; set;}
    [field : SerializeField] public int      CurHP       {get; set;}
    [field : SerializeField] public float    MoveSpeed   {get; set;}
    [field : SerializeField] public float    Defence     {get; set;}
    [field : SerializeField] public float    Tenacity    {get; set;}
    [field : SerializeField] public int      MaxStamina  {get; set;}
    [field : SerializeField] public int      CurStamina  {get; set;}
    [field : SerializeField] public float    Power       {get; set;}
    [field : SerializeField] public int      Luck        {get; set;}
    [field : SerializeField] public int      Gear        {get; set;}
    [field : SerializeField] public int      Frag        {get; set;}
    [field : SerializeField] public float    DamageRatio {get; set;}
    [field : SerializeField] public float    WeaponDelay {get; set;}
    [field : SerializeField] public float    Range       {get; set;}
    [field : SerializeField] public int      Ammo        {get; set;}
    public SkillRankInfo[] SkillRankInfos;
```

```cs
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.Events;

[CreateAssetMenu(fileName = "EquipmentAddingData", menuName = "ScriptableObject/Equipment", order = int.MaxValue)]
public class ScriptableObjEquipmentAddingData : ScriptableObject {
    public string equipmentName;
    public string description;
    public Sprite sprite;
    [field : SerializeField]
    EquipmentAddingData EquipmentAddingData;
}
```

### Git Stash í–ˆë˜ Enemy

![](2023-05-23-09-43-44.png)

![](2023-05-23-09-43-34.png)

[GitStash ì— ëŒ€í•œ ì •ë³´](https://backlog.com/git-tutorial/kr/reference/stash.html)

------------------------------------------------------------------------

### DataClone

[DeepCopy](https://zzang9ha.tistory.com/372)
ê·¸ëŸ°ë° ì‚¬ì‹¤ ìœ ë‹ˆí‹°ì—ì„œ DeepCopyë€ Instanciateë€ë‹¤..
í´ë˜ìŠ¤ë¥¼ ì¸ìŠ¤í„´ì‹œì—íŠ¸ í•˜ë©´ ëœë‹¤.

í´ë˜ìŠ¤ë¥¼ ì¸ìŠ¤í„´ì‹œì—ì´íŠ¸í•˜ë©´ ë”± ê·¸ê²ƒë§Œ ìƒê¸°ëƒ? ëŒ“ì¸  ë…¸ë…¸

<div align="center">
	<p>ğŸ”»ê´€ë ¨ ìœ íŠœë¸Œë¥¼ ë³´ë ¤ë©´ ì‚¬ì§„ í´ë¦­ğŸ”»<p>
	<a href="https://www.youtube.com/watch?v=tyjmddv4f0I"><img style="cursor: pointer;" src="https://img.youtube.com/vi/tyjmddv4f0I/maxresdefault.jpg" width=625px></a>
	<h4>á„ƒá…¡á„…á…³á†«á„á…¥á†·á„‘á…©á„‚á…¥á†«á„á…³á„…á…© á„‹á…©á„‡á…³á„Œá…¦á†¨á„á…³ á„‰á…¢á†¼á„‰á…¥á†¼á„‰á…µá†¯á„’á…¥á†·</h4>
</div>

í”„ë¦¬í©ì„ Instantiateí• ë•Œ 
GameObjectê°€ ì•„ë‹ˆë¼ ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ì„œë„ ìƒì„± ê°€ëŠ¥í•˜ë‹¤.
ê·¸ëŸ°ë°. ì—¬ê¸°ì„œ ê¶ê¸ˆí•œê²ƒì€. ğŸ¤”
- case 1 : ì»´í¬ë„ŒíŠ¸ë¡œ ìƒì„±í–ˆìœ¼ë©´ ì˜¤ì§, ê·¸ ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•´ì„œë§Œ ìƒê¸´ë‹¤
- case 2 : ë¶„ëª… ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¸ì¡°í•´ì„œ Instantiate í–ˆëŠ”ë° í”„ë¦¬í© ì°¨ì²´ê°€ ìƒê¸´ë‹¤. (ìƒì„±í–ˆë˜ ì»´í¬ë„ŒíŠ¸ ë¿ë§Œ ì•„ë‹ˆë¼ í”„ë¦¬í©ì„ ì´ë£¨ëŠ”ê²ƒ ëª¨ë‘ê°€ ê°™ì´ ë”¸ë ¤ì„œ)

ì—¬ê¸°ì„œ ì–´ëŠ ì¼€ì´ìŠ¤ê°€ ë˜ëŠ”ì§€ ê¶ê¸ˆí•´ì„œ ì‹¤í—˜í–ˆë‹¤.

â˜† ê²°ë¡  â˜† : case 2
í”„ë¦¬í©ì„ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¸ì¡°í•´ì„œ Instantiate í•´ë„ 
í”„ë¦¬í© ì°¨ì²´ê°€ ìƒê¸´ë‹¤. (ìƒì„±í–ˆë˜ ì»´í¬ë„ŒíŠ¸ ë¿ë§Œ ì•„ë‹ˆë¼ í”„ë¦¬í©ì„ ì´ë£¨ëŠ”ê²ƒ ëª¨ë‘ê°€ ê°™ì´ ë”¸ë ¤ì„œ)

ì´ë¡œì¨, Projectile ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì§€ê³  ìˆëŠ” í”„ë¦¬í©ì„ ë§Œë“¤ë•Œ, ê·¸ê±¸ ì´ë£¨ëŠ” ê²Œì„ì˜¤ë¸Œì íŠ¸ ìì²´ê°€ ìƒê¸´ë‹¤ ã…

------------------------------------------------------------------------

### Destroy(this)

ë§Œì•½ ì–´ë–¤ í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ
ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì§€ëŠ” ê²Œì„ì˜¤ë¸Œì íŠ¸ë¥¼ ì§€ì›Œë³¼ê¹Œ í•˜ê³  `Destroy(this)` ë¼ê³  í•˜ë©´ 
ì§„ì§œ ë”±, ê·¸ ì»´í¬ë„ŒíŠ¸ë§Œ ì‚­ì œëœë‹¤.

<div align="center">
	<p>ğŸ”»ê´€ë ¨ ìœ íŠœë¸Œë¥¼ ë³´ë ¤ë©´ ì‚¬ì§„ í´ë¦­ğŸ”»<p>
	<a href="https://www.youtube.com/watch?v=CbTzF9uODp4"><img style="cursor: pointer;" src="https://img.youtube.com/vi/CbTzF9uODp4/maxresdefault.jpg" width=625px></a>
	<h4>ì»´í¬ë„ŒíŠ¸ Destroy(this)ëŠ” ë”±, ê·¸ ì»´í¬ë„ŒíŠ¸ë§Œ ì‚­ì œí•œë‹¤.</h4>
</div>

ë§Œì•½ ì–´ë–¤ í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ
ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì§€ëŠ” ê²Œì„ì˜¤ë¸Œì íŠ¸ë¥¼ ì§€ì›Œë³¼ê¹Œ í•˜ê³  `Destroy(this)` ë¼ê³  í•˜ë©´ 
ì§„ì§œ ë”±, ê·¸ ì»´í¬ë„ŒíŠ¸ë§Œ ì‚­ì œëœë‹¤.

ê·¸ë˜ì„œ ë§Œì•½ ê²Œì„ ì˜¤ë¸Œì íŠ¸ê°€ ì‚­ì œëœê±´ì§€ ì•„ë‹Œì§€ 
nullcheckí• ë•Œ ë‚œê°í•œ ìƒí™©ì´ ì˜¤ë‹ˆ ì¡°ì‹¬í•˜ê¸°ë¥¼

------------------------------------------------------------------------

### RigidBodyë¥¼ ê°€ì§„ Transform ì„ SetParent í• ë•Œ ìƒê¸°ëŠ” ì´ìƒí•œ ì›€ì§ì„
ê²°ë¡ ì€ isKinematicê°€ í™œì„±í™” ë˜ì§€ ì•Šì€ RigidBody ë•Œë¬¸ì´ë‹¤.

í•´ê²°ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤
case 1 : RigidBodyë¥¼ ì—†ì—”ë‹¤
case 2 : isKinematicë¥¼ í™œì„±í™” í•œë‹¤

<div align="center">
	<p>ğŸ”»ê´€ë ¨ ìœ íŠœë¸Œë¥¼ ë³´ë ¤ë©´ ì‚¬ì§„ í´ë¦­ğŸ”»<p>
	<a href="https://www.youtube.com/watch?v=8KMXQvSntGY"><img style="cursor: pointer;" src="https://img.youtube.com/vi/8KMXQvSntGY/maxresdefault.jpg" width=625px></a>
	<h4>ì»´í¬ë„ŒíŠ¸ Destroy(this)ëŠ” ë”±, ê·¸ ì»´í¬ë„ŒíŠ¸ë§Œ ì‚­ì œí•œë‹¤.</h4>
</div>

------------------------------------------------------------------------

### ì½”ë£¨í‹´ < UniTask ì¸ ì´ìœ ë¥¼ í•˜ë‚˜ ë” ë°œê²¬í•¨

ì½”ë£¨í‹´ì˜ ë‹¨ì . GameObjectë¡œ ì¡´ì¬í•´ì•¼ì§€ ì‘ë™í•œë‹¤ëŠ”ê²ƒ.
* ë§Œì•½ ìŠ¤í¬ë¦½íŠ¸ ë‚´ì—ì„œë§Œ ì²˜ë¦¬í•˜ê³  ì‹¶ì€ë° ì´ê°€ ì¸ìŠ¤í„´ì‹œì—ì´íŠ¸ê°€ ì•ˆë˜ë©´
    ì½”ë£¨í‹´ì€ ì‘ë™ì´ ì•ˆëœë‹¤.

ê·¸ë˜ì„œ ì²˜ìŒì—” ì¸ìŠ¤í„´ì‹œì—ì´íŠ¸ í•´ì„œ ì½”ë£¨í‹´ ì‘ë™ ì‹œí‚¤ë ¤í•˜ë‹ˆ.. ì´ë ‡ê²Œê¹Œì§€ í•´ì•¼í•˜ë‚˜ ì‹¶ì–´ì„œ
UniTaskë¥¼ í•œë²ˆ ê°„ë§Œì— êº¼ë‚´ì„œ ì¨ë´¤ë‹¤

ê²°ê³¼ëŠ” ì¸ìŠ¤í„´ì‹œì—ì´íŠ¸ ì•ˆí•´ë„ ì‘ë™ì´ ë˜ëŠ”.. íšê¸°ì ì´ë”ë¼..


### ì—”í‹°í‹° í´ë˜ìŠ¤ì™€ ì´ê±¸ ìƒì† ë°›ëŠ” ì• ë“¤